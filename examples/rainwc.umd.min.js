var RainWC=(()=>{var A=Object.defineProperty;var dt=Object.getOwnPropertyDescriptor;var pt=Object.getOwnPropertyNames,H=Object.getOwnPropertySymbols;var B=Object.prototype.hasOwnProperty,ht=Object.prototype.propertyIsEnumerable;var R=(e,t,r)=>t in e?A(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,j=(e,t)=>{for(var r in t||(t={}))B.call(t,r)&&R(e,r,t[r]);if(H)for(var r of H(t))ht.call(t,r)&&R(e,r,t[r]);return e};var yt=(e,t)=>{for(var r in t)A(e,r,{get:t[r],enumerable:!0})},mt=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of pt(t))!B.call(e,o)&&o!==r&&A(e,o,{get:()=>t[o],enumerable:!(n=dt(t,o))||n.enumerable});return e};var vt=e=>mt(A({},"__esModule",{value:!0}),e);var Pt={};yt(Pt,{$:()=>w,css:()=>ct,dangerouslySetInnerHTML:()=>ut,html:()=>P,list:()=>ft,match:()=>st,onMounted:()=>at,onUnmounted:()=>lt,rain:()=>L,render:()=>D});var J=function(e,t,r,n){var o;t[0]=0;for(var i=1;i<t.length;i++){var s=t[i++],c=t[i]?(t[0]|=s?1:2,r[t[i++]]):t[++i];s===3?n[0]=c:s===4?n[1]=Object.assign(n[1]||{},c):s===5?(n[1]=n[1]||{})[t[++i]]=c:s===6?n[1][t[++i]]+=c+"":s?(o=e.apply(c,J(e,c,r,["",null])),n.push(o),c[0]?t[0]|=2:(t[i-2]=0,t[i]=o)):n.push(c)}return n},W=new Map;function K(e){var t=W.get(this);return t||(t=new Map,W.set(this,t)),(t=J(this,t.get(e)||(t.set(e,t=(function(r){for(var n,o,i=1,s="",c="",f=[0],d=function(h){i===1&&(h||(s=s.replace(/^\s*\n\s*|\s*\n\s*$/g,"")))?f.push(0,h,s):i===3&&(h||s)?(f.push(3,h,s),i=2):i===2&&s==="..."&&h?f.push(4,h,0):i===2&&s&&!h?f.push(5,0,!0,s):i>=5&&((s||!h&&i===5)&&(f.push(i,0,s,o),i=6),h&&(f.push(i,h,0,o),i=6)),s=""},p=0;p<r.length;p++){p&&(i===1&&d(),d(p));for(var l=0;l<r[p].length;l++)n=r[p][l],i===1?n==="<"?(d(),f=[f],i=3):s+=n:i===4?s==="--"&&n===">"?(i=1,s=""):s=n+s[0]:c?n===c?c="":s+=n:n==='"'||n==="'"?c=n:n===">"?(d(),i=1):i&&(n==="="?(i=5,o=s,s=""):n==="/"&&(i<5||r[p][l+1]===">")?(d(),i===3&&(f=f[0]),i=f,(f=f[0]).push(2,0,i),i=0):n===" "||n==="	"||n===`
`||n==="\r"?(d(),i=2):s+=n),i===3&&s==="!--"&&(i=4,f=f[0])}return d(),f})(e)),t),arguments,[])).length>1?t:t[0]}var gt=Symbol.for("preact-signals");function I(){if(N>1)N--;else{for(var e,t=!1;$!==void 0;){var r=$;for($=void 0,T++;r!==void 0;){var n=r.o;if(r.o=void 0,r.f&=-3,!(8&r.f)&&Y(r))try{r.c()}catch(o){t||(e=o,t=!0)}r=n}}if(T=0,N--,t)throw e}}var u=void 0;function Z(e){var t=u;u=void 0;try{return e()}finally{u=t}}var $=void 0,N=0,T=0,O=0;function G(e){if(u!==void 0){var t=e.n;if(t===void 0||t.t!==u)return t={i:0,S:e,p:u.s,n:void 0,t:u,e:void 0,x:void 0,r:t},u.s!==void 0&&(u.s.n=t),u.s=t,e.n=t,32&u.f&&e.S(t),t;if(t.i===-1)return t.i=0,t.n!==void 0&&(t.n.p=t.p,t.p!==void 0&&(t.p.n=t.n),t.p=u.s,t.n=void 0,u.s.n=t,u.s=t),t}}function y(e,t){this.v=e,this.i=0,this.n=void 0,this.t=void 0,this.W=t==null?void 0:t.watched,this.Z=t==null?void 0:t.unwatched}y.prototype.brand=gt;y.prototype.h=function(){return!0};y.prototype.S=function(e){var t=this,r=this.t;r!==e&&e.e===void 0&&(e.x=r,this.t=e,r!==void 0?r.e=e:Z(function(){var n;(n=t.W)==null||n.call(t)}))};y.prototype.U=function(e){var t=this;if(this.t!==void 0){var r=e.e,n=e.x;r!==void 0&&(r.x=n,e.e=void 0),n!==void 0&&(n.e=r,e.x=void 0),e===this.t&&(this.t=n,n===void 0&&Z(function(){var o;(o=t.Z)==null||o.call(t)}))}};y.prototype.subscribe=function(e){var t=this;return v(function(){var r=t.value,n=u;u=void 0;try{e(r)}finally{u=n}})};y.prototype.valueOf=function(){return this.value};y.prototype.toString=function(){return this.value+""};y.prototype.toJSON=function(){return this.value};y.prototype.peek=function(){var e=u;u=void 0;try{return this.value}finally{u=e}};Object.defineProperty(y.prototype,"value",{get:function(){var e=G(this);return e!==void 0&&(e.i=this.i),this.v},set:function(e){if(e!==this.v){if(T>100)throw new Error("Cycle detected");this.v=e,this.i++,O++,N++;try{for(var t=this.t;t!==void 0;t=t.x)t.t.N()}finally{I()}}}});function X(e,t){return new y(e,t)}function Y(e){for(var t=e.s;t!==void 0;t=t.n)if(t.S.i!==t.i||!t.S.h()||t.S.i!==t.i)return!0;return!1}function Q(e){for(var t=e.s;t!==void 0;t=t.n){var r=t.S.n;if(r!==void 0&&(t.r=r),t.S.n=t,t.i=-1,t.n===void 0){e.s=t;break}}}function tt(e){for(var t=e.s,r=void 0;t!==void 0;){var n=t.p;t.i===-1?(t.S.U(t),n!==void 0&&(n.n=t.n),t.n!==void 0&&(t.n.p=n)):r=t,t.S.n=t.r,t.r!==void 0&&(t.r=void 0),t=n}e.s=r}function S(e,t){y.call(this,void 0),this.x=e,this.s=void 0,this.g=O-1,this.f=4,this.W=t==null?void 0:t.watched,this.Z=t==null?void 0:t.unwatched}S.prototype=new y;S.prototype.h=function(){if(this.f&=-3,1&this.f)return!1;if((36&this.f)==32||(this.f&=-5,this.g===O))return!0;if(this.g=O,this.f|=1,this.i>0&&!Y(this))return this.f&=-2,!0;var e=u;try{Q(this),u=this;var t=this.x();(16&this.f||this.v!==t||this.i===0)&&(this.v=t,this.f&=-17,this.i++)}catch(r){this.v=r,this.f|=16,this.i++}return u=e,tt(this),this.f&=-2,!0};S.prototype.S=function(e){if(this.t===void 0){this.f|=36;for(var t=this.s;t!==void 0;t=t.n)t.S.S(t)}y.prototype.S.call(this,e)};S.prototype.U=function(e){if(this.t!==void 0&&(y.prototype.U.call(this,e),this.t===void 0)){this.f&=-33;for(var t=this.s;t!==void 0;t=t.n)t.S.U(t)}};S.prototype.N=function(){if(!(2&this.f)){this.f|=6;for(var e=this.t;e!==void 0;e=e.x)e.t.N()}};Object.defineProperty(S.prototype,"value",{get:function(){if(1&this.f)throw new Error("Cycle detected");var e=G(this);if(this.h(),e!==void 0&&(e.i=this.i),16&this.f)throw this.v;return this.v}});function et(e,t){return new S(e,t)}function rt(e){var t=e.u;if(e.u=void 0,typeof t=="function"){N++;var r=u;u=void 0;try{t()}catch(n){throw e.f&=-2,e.f|=8,U(e),n}finally{u=r,I()}}}function U(e){for(var t=e.s;t!==void 0;t=t.n)t.S.U(t);e.x=void 0,e.s=void 0,rt(e)}function wt(e){if(u!==this)throw new Error("Out-of-order effect");tt(this),u=e,this.f&=-2,8&this.f&&U(this),I()}function _(e){this.x=e,this.u=void 0,this.s=void 0,this.o=void 0,this.f=32}_.prototype.c=function(){var e=this.S();try{if(8&this.f||this.x===void 0)return;var t=this.x();typeof t=="function"&&(this.u=t)}finally{e()}};_.prototype.S=function(){if(1&this.f)throw new Error("Cycle detected");this.f|=1,this.f&=-9,rt(this),Q(this),N++;var e=u;return u=this,wt.bind(this,e)};_.prototype.N=function(){2&this.f||(this.f|=2,this.o=$,$=this)};_.prototype.d=function(){this.f|=8,1&this.f||U(this)};_.prototype.dispose=function(){this.d()};function v(e){var t=new _(e);try{t.c()}catch(n){throw t.d(),n}var r=t.d.bind(t);return r[Symbol.dispose]=r,r}var bt=()=>typeof window!="undefined"&&window.RAIN_DEBUG;function x(e,t,r){bt()&&console.log(`[Rain:${e}] ${t}`,r||"")}function nt(e){return e&&typeof e=="object"&&"value"in e&&"peek"in e}var E=Symbol("rain.signal");function k(e,t,r){t in e&&typeof e[t]!="function"?e[t]=r:r==null||r===!1?e.removeAttribute(t):r===!0?e.setAttribute(t,""):e.setAttribute(t,String(r))}function Et(e,t,r){if(t.startsWith("@")&&typeof r=="function"){let n=t.slice(1);e.addEventListener(n,r)}else nt(r)?v(()=>{k(e,t,r.value)}):typeof r=="function"&&r[E]?v(()=>{k(e,t,r())}):k(e,t,r)}function Ct(e,t,...r){if(e==="frag"){let i=document.createElement("div");i.style.display="contents";for(let s of r.flat(1/0))ot(i,s);return i}if(typeof e!="string"||!e)throw new Error(`Invalid element type: ${e}`);let n=document.createElement(e),o=null;for(let i of r.flat(1/0))ot(n,i);if(t)for(let[i,s]of Object.entries(t))n.tagName==="SELECT"&&i==="value"&&St(s)?o=s:Et(n,i,s);return o&&v(()=>{n.value=o()}),n}function ot(e,t){if(t!=null)if(typeof t=="string"||typeof t=="number")e.appendChild(document.createTextNode(String(t)));else if(typeof t=="function"&&t[E]){let r=null;v(()=>{let n=t();n instanceof Node?(r&&r.parentNode===e&&e.removeChild(r),e.appendChild(n),r=n):((!r||r.nodeType!==Node.TEXT_NODE)&&(r&&r.parentNode===e&&e.removeChild(r),r=document.createTextNode(""),e.appendChild(r)),r.textContent=String(n!=null?n:""))})}else t instanceof Node&&e.appendChild(t)}function St(e){return typeof e=="function"&&e[E]}var Nt=K.bind(Ct),_t=0,xt=()=>`__rain_instance_${++_t}`;function P(e,...t){let r=[...e];return r[r.length-1]+=`<!-- ${xt()} -->`,Nt(r,...t)}function st(e,t,r){if(typeof e!="function"||!e[E])throw new Error("match() expects a signal as first argument");if(!t||typeof t!="object")throw new Error("match() expects an object of cases as second argument");let n=document.createElement("div");n.style.display="contents";let o=null,i=v(()=>{let s=e(),c=String(s);o&&o.parentNode===n&&o.remove();let f=t[c];if(!f&&r&&(f=r),f&&typeof f=="function")try{let d=f();if(!d||!(d instanceof Node))throw new Error(`match() render function must return a DOM Node, got ${typeof d}`);n.appendChild(d),o=d}catch(d){console.error("match() render function failed:",d);let p=document.createTextNode("Match render error");n.appendChild(p),o=p}else o=null});return n._listCleanup=i,n}function ft(e,t,r){let n=document.createElement("div");n.style.display="contents",n._listCleanup=!0;let o=null;if(r){let i=new Map;o=v(()=>{let s=e();if(!Array.isArray(s))return;if(s.length===0){for(let[,a]of i)a.parentNode===n&&a.remove();i.clear();return}let c=s.map((a,m)=>r(a,m)),f=c.every(a=>a!=null),d=new Set(c).size===c.length;if(!f||!d){x("List","Invalid keys, falling back to full re-render"),Array.from(n.children).forEach(a=>a.remove()),i.clear(),s.forEach((a,m)=>{let b=t(a,m);if(!b||!(b instanceof Node))throw new Error(`renderFn must return a DOM Node, got ${typeof b}`);n.appendChild(b)});return}let p=new Set,l=[];s.forEach((a,m)=>{let b=c[m],C=i.get(b);if(p.add(b),!C){if(C=t(a,m),!C||!(C instanceof Node))throw new Error(`renderFn must return a DOM Node, got ${typeof C}`);i.set(b,C)}l.push(C)}),Array.from(n.children).forEach(a=>{a.parentNode===n&&n.removeChild(a)}),l.forEach(a=>{n.appendChild(a)});for(let[a,m]of i)p.has(a)||(m.parentNode===n&&m.remove(),i.delete(a))})}else o=v(()=>{let i=e();Array.isArray(i)&&(Array.from(n.children).forEach(s=>s.remove()),i.forEach((s,c)=>{let f=t(s,c);if(!f||!(f instanceof Node))throw new Error(`renderFn must return a DOM Node, got ${typeof f}`);n.appendChild(f)}))});return n._listCleanup=o,n}function it(e){Array.from(e.children).forEach(t=>{t._listCleanup||t.remove()})}function D(e,t){if(!t||!t.appendChild)throw new Error(`render() expects a DOM element as container, got ${typeof t}`);it(t);let r=typeof e=="function"?e():e;return r instanceof Node?(t.appendChild(r),{dispose:()=>{it(t)}}):{dispose:()=>{}}}function w(e){let t=X(e),r=()=>t.value,n=o=>{t.value=o};return r[E]=t,n[E]=t,[r,n]}w.computed=function(e){if(typeof e!="function")throw new Error("$.computed expects a function, got "+typeof e);let t=et(e),r=()=>t.value;return r[E]=t,r};w.effect=function(e){if(typeof e!="function")throw new Error("$.effect expects a function, got "+typeof e);return v(e)};w.listen=function(e,t,r=document){if(typeof e!="string")throw new Error("$.listen expects eventName to be a string");if(typeof t!="function")throw new Error("$.listen expects handler to be a function");return r.addEventListener(e,t),()=>{r.removeEventListener(e,t)}};w.emit=function(e,t,r){if(typeof e!="string")throw new Error("$.emit expects eventName to be a string");let n=r||document,o=new CustomEvent(e,{detail:t,bubbles:!0,composed:!0});n.dispatchEvent(o)};function ct(e,...t){if(!Array.isArray(e))throw new Error("css must be used as a template literal");return w.computed(()=>{let r="";for(let o=0;o<e.length;o++)if(r+=e[o],o<t.length){let i=t[o];r+=typeof i=="function"&&i[E]?i():i}let n=document.createElement("style");return n.textContent=r,n})}function ut(e){if(typeof e!="string")throw new Error("dangerouslySetInnerHTML expects a string");let t=document.createElement("div");t.innerHTML=e;let r=document.createDocumentFragment();for(;t.firstChild;)r.appendChild(t.firstChild);return r}var Mt={String:e=>e==null?"":String(e),Number:e=>{if(e==null||e==="")return 0;let t=Number(e);return isNaN(t)?0:t},Boolean:e=>typeof e=="boolean"?e:!(e==="false"||e==="0"||e==null||e===""),Object:e=>{if(e==null)return null;if(typeof e=="object")return e;if(typeof e=="string"){if(e==="")return null;if(e.startsWith("{"))try{return JSON.parse(e)}catch(t){return console.warn("Invalid JSON for Object prop:",e),null}}return null},Array:e=>{if(e==null)return[];if(Array.isArray(e))return e;if(typeof e=="string"){if(e==="")return[];if(e.startsWith("["))try{return JSON.parse(e)}catch(t){return console.warn("Invalid JSON for Array prop:",e),[]}}return[]},Function:e=>typeof e=="function"?e:null},V=class{constructor(t,r){this.element=r,this.propDefs=this.normalizePropDefs(t),this.observedAttributes=this.getObservedAttributes()}normalizePropDefs(t){let r={};for(let[n,o]of Object.entries(t))typeof o=="function"?r[n]={type:o}:r[n]={type:o.type||String,default:o.default,required:o.required||!1,validator:o.validator};return r}getObservedAttributes(){return Object.entries(this.propDefs).filter(([t,r])=>r.type!==Function).map(([t])=>t)}getInitialProps(){let t={};for(let[r,n]of Object.entries(this.propDefs)){let o;r in this.element&&this.element[r]!==void 0?o=this.element[r]:this.element.hasAttribute(r)?o=this.element.getAttribute(r):"default"in n?o=typeof n.default=="function"?n.default():n.default:o=this.getTypeDefault(n.type),o=this.coerceValue(o,n.type),this.validateProp(r,o,n),t[r]=o}return t}getTypeDefault(t){switch(t){case String:return"";case Number:return 0;case Boolean:return!1;case Array:return[];case Object:return null;case Function:return null;default:return null}}coerceValue(t,r){let n=Mt[r.name];return n?n(t):t}validateProp(t,r,n){if(n.required&&(r==null||r==="")&&console.error(`Required prop '${t}' is missing on ${this.element.tagName}`),n.validator&&r!=null)try{n.validator(r)||console.warn(`Prop '${t}' failed validation:`,r)}catch(o){console.error(`Validator error for prop '${t}':`,o)}}handleAttributeChange(t,r){let n=this.propDefs[t];if(!n||n.type===Function)return null;let o=this.coerceValue(r,n.type);return this.validateProp(t,o,n),o}setupPropertyDescriptors(t,r){for(let[n,o]of Object.entries(this.propDefs))this.element.hasOwnProperty(n)||Object.defineProperty(this.element,n,{get(){return t(n)},set:i=>{let s=this.coerceValue(i,o.type);this.validateProp(n,s,o),r(n,s)},enumerable:!0,configurable:!0})}};function F(e,t){return new V(e,t)}function M(e,t,r){console.error(`Component error in ${t} during ${r}:`,e)}function q(e,t,r){if(typeof t=="function"&&(r=t,t={}),!e||typeof e!="string")throw new Error("Component name is required and must be a string");if(!r||typeof r!="function")throw new Error("Component factory function is required");return{name:e,propDefs:t||{},factory:r}}function $t(e,t){return{renderError:n=>(console.error(`Component error in ${t}:`,n),P`<div style="color: red; padding: 1rem;">
      Component "${t}" failed to render. Check console for details.
    </div>`)}}function At(e){e._m=[],e._um=[]}function Ot(e){e._cleanups=new Set}function z(e,t,r,n="closed"){return class extends HTMLElement{static get observedAttributes(){return F(t,{hasAttribute:()=>!1,getAttribute:()=>null,tagName:e.toUpperCase()}).observedAttributes}constructor(){super(),this._propsManager=F(t,this);let o=this._propsManager.getInitialProps(),[i,s]=w(o);this._propsSignal=i,this._setPropsSignal=s,this._isInitializing=!0,this._propsManager.setupPropertyDescriptors(l=>this._propsSignal()[l],(l,h)=>{if(this._isInitializing){let a=this._propsSignal();a[l]=h}else{let a=()=>{let m=j({},this._propsSignal());m[l]=h,this._setPropsSignal(m)};typeof queueMicrotask=="function"?queueMicrotask(a):Promise.resolve().then(a)}}),At(this),Ot(this);let{renderError:c}=$t(this,e);this.renderError=c;let f;n==="none"?(f=this,this._usingShadowDOM=!1):(f=this.attachShadow({mode:n}),this._usingShadowDOM=!0),g=this,this.emit=(l,h)=>{this.dispatchEvent(new CustomEvent(l,{detail:h,bubbles:!0,composed:!0}))};let d;try{d=r.call(this,i)}catch(l){M(l,e,"factory"),d=()=>this.renderError(l)}this._isInitializing=!1,g=null;let p;try{p=d()}catch(l){M(l,e,"render"),p=this.renderError(l)}try{D(p,f)}catch(l){M(l,e,"render-critical"),f.innerHTML=`<div style="padding: 1rem; background: #fee; border: 1px solid #fcc;">
          <strong style="color: #c00;">Critical Render Error: ${e}</strong>
        </div>`}this._root=f,this._isMounted=!1}_cleanupElement(o){o._listCleanup&&typeof o._listCleanup=="function"&&(o._listCleanup(),o._listCleanup=null),Array.from(o.children).forEach(i=>{this._cleanupElement(i)})}connectedCallback(){var o;this._isMounted=!0,(o=this._m)==null||o.forEach(i=>{try{i()}catch(s){M(s,this.tagName.toLowerCase(),"connected")}})}disconnectedCallback(){var o,i;(o=this._cleanups)==null||o.forEach(s=>{if(typeof s=="function")try{s()}catch(c){M(c,this.tagName.toLowerCase(),"cleanup")}}),(i=this._um)==null||i.forEach(s=>{try{s()}catch(c){M(c,this.tagName.toLowerCase(),"unmount")}})}attributeChangedCallback(o,i,s){let c=this._propsManager.handleAttributeChange(o,s);if(c!==null){let f=j({},this._propsSignal());f[o]=c,this._setPropsSignal(f)}}}}var g;function L(e,t,r){try{let{name:n,propDefs:o,factory:i}=q(e,t,r);if(customElements.get(n))return x("Component",`'${n}' already defined, skipping`),!0;let s=z(n,o,i,"closed");return customElements.define(n,s),!0}catch(n){return console.error(`Failed to register component '${e}':`,n),!1}}L.open=function(e,t,r){try{let{name:n,propDefs:o,factory:i}=q(e,t,r);if(customElements.get(n))return x("Component",`'${n}' already defined, skipping`),!0;let s=z(n,o,i,"open");return customElements.define(n,s),!0}catch(n){return console.error(`Failed to register component '${e}':`,n),!1}};L.light=function(e,t,r){try{let{name:n,propDefs:o,factory:i}=q(e,t,r);if(customElements.get(n))return x("Component",`'${n}' already defined, skipping`),!0;let s=z(n,o,i,"none");return customElements.define(n,s),!0}catch(n){return console.error(`Failed to register component '${e}':`,n),!1}};function at(e){if(!g){console.warn("onMounted called outside component factory");return}(g._m||(g._m=[])).push(e)}function lt(e){if(!g){console.warn("onUnmounted called outside component factory");return}(g._um||(g._um=[])).push(e)}return vt(Pt);})();
/**
 * @fileoverview RainJS - Reactive Web Components with HTM templates and Preact signals
 * @version 0.0.7
 * @author RainJS Team
 * @license MIT
 */
//# sourceMappingURL=rainwc.umd.min.js.map
