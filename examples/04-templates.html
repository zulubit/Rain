<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Templates - RainJS</title>
  <style>
    body {
      font-family: system-ui, -apple-system, sans-serif;
      max-width: 800px;
      margin: 0 auto;
      padding: 2rem;
      background: #f5f5f5;
    }
    .example {
      background: white;
      padding: 1.5rem;
      border-radius: 8px;
      margin: 1rem 0;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    h1 { color: #333; }
    h2 { color: #666; margin-top: 2rem; }
  </style>
</head>
<body>
  <h1>üåßÔ∏è Templates</h1>
  
  <div class="example">
    <h2>Dynamic Content</h2>
    <dynamic-content></dynamic-content>
  </div>

  <div class="example">
    <h2>Event Handlers</h2>
    <event-demo></event-demo>
  </div>
  
  <div class="example">
    <h2>Simple Lists</h2>
    <list-demo></list-demo>
  </div>

  <div class="example">
    <h2>Keyed Lists (Smart Reconciliation)</h2>
    <keyed-list-demo></keyed-list-demo>
  </div>

  <script src="./rainjs.umd.min.js"></script>
  <script>
    const { rain, html, $, match, list } = RainJS
    
    // Dynamic content
    rain('dynamic-content', function() {
      const [count, setCount] = $(0)
      const [show, setShow] = $(true)
      
      const doubled = $.computed(() => count() * 2)
      
      return () => html`
        <div>
          <h3>Count: ${count}</h3>
          <p>Double: ${doubled}</p>
          ${match(show, {
            'true': () => html`<p>Visible!</p>`,
            'false': () => html`<p>Hidden!</p>`
          })}
          <button @click=${() => setCount(count() + 1)}>+</button>
          <button @click=${() => setShow(!show())}>Toggle</button>
        </div>
      `
    })
    
    // Event handlers
    rain('event-demo', function() {
      const [message, setMessage] = $('')
      
      return () => html`
        <div>
          <button @click=${() => setMessage('Clicked!')}>Click Me</button>
          <input @input=${(e) => setMessage(e.target.value)} placeholder="Type here" />
          <p>${message}</p>
        </div>
      `
    })
    
    // Simple lists
    rain('list-demo', function() {
      const [items, setItems] = $(['apple', 'banana'])
      
      const addItem = () => {
        setItems([...items(), 'new item'])
      }
      
      return () => html`
        <div>
          ${list(items, item => html`<li>${item}</li>`)}
          <button @click=${addItem}>Add Item</button>
        </div>
      `
    })
    
    // Keyed lists for smart reconciliation
    rain('keyed-list-demo', function() {
      const [todos, setTodos] = $([
        { id: 1, text: 'Learn RainJS', done: false },
        { id: 2, text: 'Build app', done: true },
        { id: 3, text: 'Deploy', done: false }
      ])
      
      let nextId = 4
      
      const addTodo = () => {
        const newTodo = { id: nextId++, text: `Task ${nextId-1}`, done: false }
        setTodos([...todos(), newTodo])
      }
      
      const toggleTodo = (id) => {
        setTodos(todos().map(todo => 
          todo.id === id ? { ...todo, done: !todo.done } : todo
        ))
      }
      
      const removeTodo = (id) => {
        setTodos(todos().filter(todo => todo.id !== id))
      }
      
      return () => html`
        <div>
          ${list(todos, 
            todo => html`
              <div>
                <input 
                  type="checkbox" 
                  .checked=${todo.done}
                  @change=${() => toggleTodo(todo.id)}
                />
                <span>${todo.text}</span>
                <button @click=${() => removeTodo(todo.id)}>√ó</button>
              </div>
            `,
            todo => todo.id
          )}
          <button @click=${addTodo}>Add Todo</button>
        </div>
      `
    })
  </script>
</body>
</html>